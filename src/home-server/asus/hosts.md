---
title: 华硕路由器修改hosts的完美解决方案
date: 2024/08/18
---
# 华硕路由器修改hosts的完美解决方案
## 简介
针对华硕路由器修改hosts文件以实现特定域名解析的需求，特别是希望修改后的设置能对局域网内所有设备生效，并且在路由器重启后仍能保持这些修改，可以遵循以下步骤来实现一个较为完美的解决方案：
## 启用SSH访问
  - 登录到华硕路由器的管理界面，进入`“高级设置” -> “系统管理” -> “系统设置”`部分，找到并启用SSH服务。    
## 修改hosts文件  
  - 使用SSH客户端（如PuTTY）连接到路由器。默认用户名和密码通常在路由器的文档中能找到。
  - 通过SSH命令行，使用文本编辑器（如vi或nano）编辑/etc/hosts文件，添加或修改需要的域名与IP映射。例如：
    `192.168.1.100 example.com`
## 确保修改对局域网生效
  - 修改完hosts后，需要通知DNS服务更新。执行命令`killall -SIGHUP dnsmasq`来重载DNS配置，使更改立即生效。
## 永久性修改
  - 为了确保路由器重启后hosts文件的修改不会丢失，需要在路由器上设置开机自启动脚本。
  - 创建一个脚本文件，比如在`/jffs/scripts`目录下创建post-mount（确保该目录存在或创建），并在其中包含修改hosts文件的命令和重载DNS服务的命令。
  - 脚本内容示例：
  ```bash
  #!/bin/sh
  echo "192.168.1.100 example.com" >> /etc/hosts
  killall -SIGHUP dnsmasq
```
  - 要使脚本在启动时自动执行，通常需要设置文件权限为可执行，命令为`chmod +x /jffs/scripts/post-mount`。具体方法可能根据路由器型号和固件版本有所不同，需参考路由器的官方文档或梅林固件的社区指南。
## DNS服务配置（针对更高级需求）
对于更复杂的DNS需求，如支持通配符或更精细的控制，可以考虑在路由器上安装和配置更强大的DNS服务器软件，如 BIND 或 Unbound，但这通常需要更高级的Linux系统管理知识。
## 测试与验证
  - 在完成上述步骤后，从局域网内的不同设备尝试访问你修改过的域名，确认是否正确解析到指定的IP地址。
通过上述步骤，你可以实现华硕路由器hosts文件的完美修改，确保设置的持久性和对整个局域网的适用性。不过，具体操作时请根据路由器的当前固件版本和实际界面可能存在的差异进行适当调整。